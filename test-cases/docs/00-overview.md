# Period Calculator 테스트 케이스 개요

## 📋 테스트 케이스 구조

이 테스트 케이스 문서는 **입력 조건별로 파일을 분리**하고, **각 파일 내에서 조회 기간을 다양화**하는 구조로 작성되었습니다.

### 구조 원칙
1. **파일 분리**: 입력 조건(생리 주기, 피임약, 배란 테스트 등)별로 별도 파일
2. **조회 기간 다양화**: 각 파일 내에서 1일, 1주일, 1개월, 3개월 등 다양한 조회 기간 테스트
3. **일관성**: 동일 파일 내 모든 테스트 케이스는 동일한 입력 조건 사용

---

## 📁 파일 구조 및 테스트 케이스

### [01-basic-regular-cycle.md](./01-basic-regular-cycle.md) - 기본 규칙적인 28일 주기
**공통 입력 조건**: 28일 주기, 3개월 생리 기록

**그룹 1: 마지막 생리 이후 (Period 3)**
- **TC-01-01**: 1일 조회 (마지막 생리 이후)
- **TC-01-02**: 1주일 조회 (마지막 생리 이후)
- **TC-01-03**: 1개월 조회 (마지막 생리 이후)

**그룹 2: 과거 기록 (Period 2)**
- **TC-01-04**: 1일 조회 (과거)
- **TC-01-05**: 1주일 조회 (과거)
- **TC-01-06**: 1개월 조회 (과거)

**그룹 3: 장기 조회 및 특수 경계**
- **TC-01-07**: 생리 기간 경계 조회
- **TC-01-08**: 3개월 조회

**그룹 4: 특정 기간 타입 조회**
- **TC-01-09**: 생리 예정 기간 중 조회
- **TC-01-10**: 배란기 중 조회
- **TC-01-11**: 가임기 중 조회

**그룹 5: 생리 지연**
- **TC-01-12**: 생리 지연 1-7일 (예정일 뒤로 미룸)
- **TC-01-13**: 생리 지연 8일 이상 (예정일 표시 안 함, 병원 권장)

**총 13개 테스트 케이스**

---

### [02-short-cycle.md](./02-short-cycle.md) - 짧은 주기 (25일)
**공통 입력 조건**: 25일 주기, 3개월 생리 기록

**그룹 1: 마지막 생리 이후 (Period 3)**
- **TC-02-01**: 1일 조회 (마지막 생리 이후)
- **TC-02-02**: 1주일 조회 (마지막 생리 이후)
- **TC-02-03**: 1개월 조회 (마지막 생리 이후)

**그룹 2: 과거 기록 (Period 2)**
- **TC-02-04**: 1일 조회 (과거)
- **TC-02-05**: 1주일 조회 (과거)
- **TC-02-06**: 1개월 조회 (과거)

**그룹 3: 장기 조회 및 특수 경계**
- **TC-02-07**: 생리 기간 경계 조회
- **TC-02-08**: 3개월 조회

**그룹 4: 특정 기간 타입 조회**
- **TC-02-09**: 생리 예정 기간 중 조회
- **TC-02-10**: 배란기 중 조회
- **TC-02-11**: 가임기 중 조회

**그룹 5: 생리 지연**
- **TC-02-12**: 생리 지연 1-7일 (예정일 뒤로 미룸)
- **TC-02-13**: 생리 지연 8일 이상 (예정일 표시 안 함, 병원 권장)

**총 13개 테스트 케이스**

**주요 차이점**: 25일 주기 (26일 미만)
- 배란기: period - 16 ~ period - 14일째 (시작일 + 9 ~ 시작일 + 11)
- 가임기: period - 19 ~ period - 11일째 (시작일 + 6 ~ 시작일 + 14)

---

### [03-long-cycle.md](./03-long-cycle.md) - 긴 주기 (35일)
**공통 입력 조건**: 35일 주기, 3개월 생리 기록

**그룹 1: 마지막 생리 이후 (Period 3)**
- **TC-03-01**: 1일 조회 (미래)
- **TC-03-02**: 1주일 조회 (미래)
- **TC-03-03**: 1개월 조회 (미래)

**그룹 2: 과거 기록 중심 (Period 2)**
- **TC-03-04**: 1일 조회 (과거)
- **TC-03-05**: 1주일 조회 (과거)
- **TC-03-06**: 1개월 조회 (과거)

**그룹 3: 장기 조회 및 특수 경계**
- **TC-03-07**: 생리 기간 경계 조회
- **TC-03-08**: 3개월 조회

**그룹 4: 특정 기간 타입 조회**
- **TC-03-09**: 생리 예정 기간 중 조회
- **TC-03-10**: 배란기 중 조회
- **TC-03-11**: 가임기 중 조회

**그룹 5: 생리 지연**
- **TC-03-12**: 생리 지연 1-7일 (예정일 뒤로 미룸)
- **TC-03-13**: 생리 지연 8일 이상 (병원 추천)

**총 13개 테스트 케이스**

**주요 차이점**: 35일 주기 (32일 초과)
- 배란기: 19-21일차 (period - 16 ~ period - 14)
- 가임기: 16-24일차 (period - 19 ~ period - 11)

---

### [04-irregular-cycle.md](./04-irregular-cycle.md) - 불규칙한 주기
**공통 입력 조건**: 25일/32일/31일 불규칙 주기, 자동 계산 사용

**그룹 1: 마지막 생리 이후 (Period 4)**
- **TC-04-01**: 1일 조회 (마지막 생리 이후)
- **TC-04-02**: 1주일 조회 (마지막 생리 이후)
- **TC-04-03**: 1개월 조회 (마지막 생리 이후)

**그룹 2: 과거 기록 (Period 3)**
- **TC-04-04**: 1일 조회 (과거)
- **TC-04-05**: 1주일 조회 (과거)
- **TC-04-06**: 1개월 조회 (과거)

**그룹 3: 장기 조회 및 특수 경계**
- **TC-04-07**: 생리 기간 경계 조회
- **TC-04-08**: 3개월 조회

**그룹 4: 특정 기간 타입 조회**
- **TC-04-09**: 생리 예정 기간 중 조회
- **TC-04-10**: 배란기 중 조회
- **TC-04-11**: 가임기 중 조회

**그룹 5: 생리 지연**
- **TC-04-12**: 생리 지연 1-7일 (예정일 뒤로 미룸)
- **TC-04-13**: 생리 지연 8일 이상 (병원 추천)

**총 13개 테스트 케이스**

**주요 차이점**: 평균 주기 29일로 자동 계산, 26-32일 범위 내 공식 적용

---

### [05-with-pill.md](./05-with-pill.md) - 피임약 복용
**공통 입력 조건**: 피임약 패키지 시작일 설정, 복용일 21일 + 휴약일 7일

- **TC-05-01**: 1일 조회
- **TC-05-02**: 1주일 조회
- **TC-05-03**: 1개월 조회 (휴약기 포함)
- **TC-05-04**: 3개월 조회
- **TC-05-05**: 생리 기간 중 조회 (휴약기)
- **TC-05-06**: 복용 기간 중 조회
- **TC-05-07**: 복용 시작일 포함 조회

**총 7개 테스트 케이스**

**주요 차이점**: 
- 주기 = 28일 고정 (복용일 + 휴약일)
- 배란기/가임기 없음 (배란 억제)
- 휴약기 = 생리 예정 기간

---

### [06-with-ovulation-test.md](./06-with-ovulation-test.md) - 배란 테스트 기록
**공통 입력 조건**: 배란 테스트 양성 기록 포함

- **TC-06-01**: 1일 조회
- **TC-06-02**: 1주일 조회
- **TC-06-03**: 1개월 조회 (생리 사이)
- **TC-06-04**: 3개월 조회
- **TC-06-05**: 생리 기간 중 조회
- **TC-06-06**: 배란기 중 조회 (테스트 기록 날짜)
- **TC-06-07**: 가임기 중 조회 (테스트 결과 기반)

**총 7개 테스트 케이스**

**주요 차이점**:
- 배란기: 테스트 양성 날짜 기준
- 가임기: 배란일 -2일 ~ +1일

---

### [07-with-manual-ovulation.md](./07-with-manual-ovulation.md) - 수동 배란일 입력
**공통 입력 조건**: 사용자가 직접 입력한 배란일 포함

- **TC-07-01**: 1일 조회
- **TC-07-02**: 1주일 조회
- **TC-07-03**: 1개월 조회 (생리 사이)
- **TC-07-04**: 3개월 조회
- **TC-07-05**: 생리 기간 중 조회
- **TC-07-06**: 배란기 중 조회 (사용자 입력 날짜)
- **TC-07-07**: 가임기 중 조회 (사용자 입력 기반)

**총 7개 테스트 케이스**

**주요 차이점**:
- 배란기: 사용자 입력 날짜 (특정 날짜)
- 가임기: 배란일 -2일 ~ +1일

---

### [08-edge-cases.md](./08-edge-cases.md) - 엣지 케이스
**각 케이스별로 서로 다른 입력 조건 사용**

#### 케이스 1: 생리 지연
- TC-08-01-01: 1일 조회 (지연 기간 중)
- TC-08-01-02: 1주일 조회 (지연 기간 중)
- TC-08-01-03: 1개월 조회 (지연 포함)
- TC-08-01-04: 3개월 조회

#### 케이스 2: 매우 짧은 주기 (21일)
- TC-08-02-01: 1일 조회
- TC-08-02-02: 1주일 조회
- TC-08-02-03: 1개월 조회
- TC-08-02-04: 3개월 조회

#### 케이스 3: 매우 긴 주기 (45일)
- TC-08-03-01: 1일 조회
- TC-08-03-02: 1주일 조회
- TC-08-03-03: 1개월 조회
- TC-08-03-04: 3개월 조회

**총 12개 테스트 케이스**

---

### [09-complex-scenarios.md](./09-complex-scenarios.md) - 복합 시나리오
**각 시나리오별로 서로 다른 특수 상황 설정**

#### 시나리오 1: 피임약 + 배란 테스트 (모순 데이터)
- TC-09-01-01: 1일 조회
- TC-09-01-02: 1주일 조회
- TC-09-01-03: 1개월 조회 (휴약기 포함)
- TC-09-01-04: 3개월 조회

#### 시나리오 2: 장기간 기록 공백 후 재시작
- TC-09-02-01: 1일 조회
- TC-09-02-02: 1주일 조회
- TC-09-02-03: 1개월 조회
- TC-09-02-04: 3개월 조회

#### 시나리오 3: 매우 긴 조회 기간 (1년)
- TC-09-03-01: 1일 조회
- TC-09-03-02: 1주일 조회
- TC-09-03-03: 6개월 조회
- TC-09-03-04: 1년 조회

#### 시나리오 4: 생리 중 조회
- TC-09-04-01: 1일 조회 (생리 중)
- TC-09-04-02: 1주일 조회 (생리 시작 포함)
- TC-09-04-03: 1개월 조회 (생리 전후)
- TC-09-04-04: 3개월 조회

**총 16개 테스트 케이스**

---

## 📊 전체 테스트 케이스 통계

| 파일 | 테스트 케이스 수 | 주요 테스트 영역 |
|------|------------------|------------------|
| 01-basic-regular-cycle.md | 13 | 28일 규칙적 주기 + 생리 지연 |
| 02-short-cycle.md | 13 | 25일 짧은 주기 + 생리 지연 |
| 03-long-cycle.md | 13 | 35일 긴 주기 + 생리 지연 |
| 04-irregular-cycle.md | 13 | 불규칙 주기 + 자동 계산 + 생리 지연 |
| 05-with-pill.md | 7 | 피임약 복용 |
| 06-with-ovulation-test.md | 7 | 배란 테스트 기록 |
| 07-with-manual-ovulation.md | 7 | 수동 배란일 입력 |
| 08-edge-cases.md | 12 | 엣지 케이스 (지연, 극단적 주기) |
| 09-complex-scenarios.md | 16 | 복합 시나리오 |
| **합계** | **101** | |

---

## 🎯 테스트 커버리지 매트릭스

### 주기 범위별 커버리지
| 주기 범위 | 파일 | 계산 공식 |
|-----------|------|-----------|
| 21일 | 08-edge-cases (케이스 2) | period - 16 ~ period - 14 |
| 25일 | 02-short-cycle | period - 16 ~ period - 14 |
| 26-32일 | 01-basic-regular-cycle, 04-irregular-cycle | 13-15일차 (배란기), 8-19일차 (가임기) |
| 35일 | 03-long-cycle | period - 16 ~ period - 14 |
| 45일 | 08-edge-cases (케이스 3) | period - 16 ~ period - 14 |

### 특수 입력별 커버리지
| 입력 유형 | 파일 | 우선순위 |
|-----------|------|----------|
| 피임약 | 05-with-pill, 09-complex (시나리오 1) | 최우선 (배란 억제) |
| 배란 테스트 | 06-with-ovulation-test | 높음 (기본 공식보다 우선) |
| 수동 배란일 | 07-with-manual-ovulation | 높음 (기본 공식보다 우선) |
| 자동 계산 | 04-irregular-cycle | 평균값 사용 |

### 조회 기간별 커버리지
| 조회 기간 | 테스트 케이스 수 | 목적 |
|-----------|------------------|------|
| 1일 | 9개 파일 × 1 = 9 | 특정 날짜 상태 검증 |
| 1주일 | 9개 파일 × 1 = 9 | 짧은 기간 필터링 검증 |
| 1개월 (생리 사이) | 7개 파일 × 1 = 7 | 주기 내 계산 검증 |
| 3개월 | 9개 파일 × 1 = 9 | 다중 주기 반복 검증 |
| 특수 조회 | 기타 | 생리 중, 배란기 중, 가임기 중 등 |

---

## 📖 용어 정의

### 배란일 vs 배란기
- **배란일**: 사용자가 직접 입력하거나 테스트로 확인한 **특정 날짜**
  - 예: 2025-01-15 (사용자 직접 입력)
  - 예: 2025-01-15 (배란 테스트 양성)
- **배란기**: 시스템이 계산한 **날짜 범위**
  - 예: 2025-01-14 ~ 2025-01-16 (3일 범위)

### 가임기
- 배란일 기준: 배란일 -2일 ~ +1일 (4일)
- 주기 기준 (26-32일): 생리 시작 8-19일차 (12일)
- 주기 기준 (기타): period - 19 ~ period - 11

---

## ✅ 검증 포인트

### 1. 주기 계산 정확성
- **26-32일 범위 내**: 배란기 13-15일차, 가임기 8-19일차
- **26일 미만/32일 초과**: period - 16 ~ period - 14, period - 19 ~ period - 11
- **피임약**: 고정 28일 주기 (복용일 + 휴약일)

### 2. 우선순위 검증
1. 피임약 설정 (배란 억제)
2. 사용자 직접 입력 배란일
3. 배란 테스트 양성 기록
4. 기본 계산 공식

### 3. 조회 기간 필터링
- 조회 기간 내 데이터만 반환
- 부분 포함 처리 (시작/종료가 조회 기간 밖)
- 빈 결과 처리

### 4. 엣지 케이스 처리
- 생리 지연 (8일 이상 경고)
- 극단적 주기 (21일, 45일)
- 데이터 공백 (장기간 기록 없음)
- 모순 데이터 (피임약 + 배란 테스트)

### 5. 성능
- 긴 조회 기간 (1년) 처리
- 다중 주기 계산 효율성
- 메모리 사용량

---

## 🔄 테스트 케이스 작성 가이드

새로운 테스트 케이스를 추가할 때는 다음 템플릿을 사용하세요:

```markdown
## TC-XX-XX: [테스트 케이스 이름]
### 📌 테스트 목적
[무엇을 검증하는지 명확히 작성]

### 📝 입력 조건
- **조회 기간**: 
  - 시작: YYYY-MM-DD
  - 종료: YYYY-MM-DD

### ✅ 예상 결과
- **실제 생리 기록**: [DateRange 또는 없음, pk 포함]
- **생리 예정일들**: [DateRange 리스트]
- **생리 지연일**: [Int 또는 없음]
- **배란기들**: [DateRange 리스트]
- **가임기들**: [DateRange 리스트]
- **주기**: [Int]일

### 🔍 검증 포인트
- [ ] 검증 항목 1
- [ ] 검증 항목 2
```

---

## 📝 참고사항

1. **오늘 날짜**: 모든 테스트에서 "오늘 날짜"는 미래 시점이어야 함 (생리 기록 이후)
2. **조회 기간**: 다양한 조회 기간으로 필터링 동작 검증
3. **입력 조건 일관성**: 같은 파일 내 모든 테스트는 동일한 생리 기록/설정 사용
4. **날짜 계산**: 0-based 인덱스 주의 (1일차 = 인덱스 0)
5. **반올림**: 평균 주기 계산 시 반올림 적용 (29.33 → 29)
